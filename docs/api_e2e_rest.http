@base = http://localhost:3000
@cookie = sb-access-token=REEMPLAZA_AQUI; sb-refresh-token=REEMPLAZA_AQUI

### Salud (pÃºblico)
GET {{base}}/api/health
Content-Type: application/json; charset=utf-8

### Ping + verificaciÃ³n DB (pÃºblico)
GET {{base}}/api/ping
Content-Type: application/json; charset=utf-8

### Yo (requiere sesiÃ³n) â€” usa Cookie con tokens de Supabase
GET {{base}}/api/me
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

### Crear Request (requiere sesiÃ³n)
POST {{base}}/api/requests
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "title": "InstalaciÃ³n elÃ©ctrica",
  "city": "Monterrey",
  "description": "Cableado bÃ¡sico 110v en cocina",
  "category": "Electricidad",
  "subcategories": ["InstalaciÃ³n", "Mantenimiento"],
  "budget": 1200
}

> {% client.global.set("REQUEST_ID", response.body.data.id); %}

### Detalle del Request (pÃºblico: activas + propias por RLS)
GET {{base}}/api/requests/{{REQUEST_ID}}
Content-Type: application/json; charset=utf-8

### Prospects para Request (dueÃ±o del request)
GET {{base}}/api/requests/{{REQUEST_ID}}/prospects
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

### Postularse a Request (pro)
POST {{base}}/api/applications
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "request_id": "{{REQUEST_ID}}",
  "note": "Listo para hoy a las 10"
}

> {% client.global.set("APPLICATION_ID", response.body.data.id); client.global.set("PRO_USER_ID", response.body.data.professional_id); %}

### Crear Acuerdo (cliente o pro, segÃºn RLS)
POST {{base}}/api/agreements
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "request_id": "{{REQUEST_ID}}",
  "professional_id": "{{PRO_USER_ID}}"
}

> {% client.global.set("AGREEMENT_ID", response.body.data.id); %}

### Listar Acuerdos por Request
GET {{base}}/api/requests/{{REQUEST_ID}}/agreements
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

### Aceptar Acuerdo
PATCH {{base}}/api/agreements/{{AGREEMENT_ID}}
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "status": "accepted"
}

### Marcar en progreso
PATCH {{base}}/api/agreements/{{AGREEMENT_ID}}
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "status": "in_progress"
}

### Completar Acuerdo
PATCH {{base}}/api/agreements/{{AGREEMENT_ID}}
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "status": "completed"
}

### Iniciar Conversación (chat)
POST {{base}}/api/chat/start
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "requestId": "{{REQUEST_ID}}",
  "proId": "{{PRO_USER_ID}}"
}

> {% client.global.set("CONVERSATION_ID", response.body.data.id || response.body.conversation.id); %}

### Enviar Mensaje a Conversación
POST {{base}}/api/chat/send
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "conversationId": "{{CONVERSATION_ID}}",
  "body": "Hola, puedo mañana a las 10"
}

### Historial de Conversación
GET {{base}}/api/chat/history?conversationId={{CONVERSATION_ID}}&limit=50
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

### Explorar Profesionales (público) (pÃºblico)
GET {{base}}/api/professionals?city=Monterrey&category=Electricidad&page=1
Content-Type: application/json; charset=utf-8

### Upsert Perfil Profesional (requiere sesiÃ³n)
POST {{base}}/api/professionals
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "full_name": "Juan PÃ©rez",
  "headline": "TÃ©cnico Electricista",
  "city": "Monterrey",
  "cities": ["Monterrey", "San NicolÃ¡s"],
  "categories": ["Electricidad"],
  "subcategories": ["InstalaciÃ³n", {"name":"Cableado"}]
}

### Stripe Checkout (opcional: requiere STRIPE_SECRET_KEY configurado en server)
POST {{base}}/api/stripe/checkout
Content-Type: application/json; charset=utf-8
Cookie: {{cookie}}

{
  "request_id": "{{REQUEST_ID}}",
  "agreement_id": "{{AGREEMENT_ID}}"
}


